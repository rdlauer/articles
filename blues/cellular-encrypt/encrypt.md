# The Most Secure Way to Deliver Data from Device to Cloud

Bold statement, no?

Ignoring this borderline clickbait headline, I do stand behind this statement, or at least with a qualifier: "within reason".

My hypothesis is the Blues Wireless Notecard and its API provide the means to transfer data from the point of collection (your MCU or SBC) to the cloud in the most secure way possible (again, within reason ðŸ˜€).

To prove out my hypothesis, we need to look at how the combination of the Notecard and the Blues Wireless cloud service Notehub.io work together to secure data at each stage of its journey.

IMAGE 

## Encrypting Notecard Data

When we talk about data "at rest", we mean at any point it is stored in flash memory or written to disk. This data is considered unsecured if the device is compromised physically or another process consumes the data for nefarious purposes. Unlikely, but not impossible, for many IoT deployments.

If you are building a solution that requires end-to-end encryption, or even if you just want to play it safe, securing data at rest is worth considering.

*So how is this accomplished with the Notecard?*

The Notecard can now encrypt the body (i.e. the data you supply) of every Note generated by your host MCU or SBC. These encrypted Notes are then securely delivered to Notehub.io (see "Securing Data in Transit" below), where they can be routed to your cloud application, where they are finally decrypted.

Starting with firmware version 1.5.5, the Notecard API adds an optional `key` parameter in the `note.add` request. The `key` stores a reference to a [Notehub environment variable](NEED) which in turn stores your public encryption key.

The workflow for implementing end-to-end encryption of your Notes encompasses:

1. Generating an RSA key pair.
1. Adding the contents of your RSA public key to an environment variable in Notehub.
1. Using the `key` parameter with each `note.add` request, providing the name of said environment variable.
1. Creating a Notehub Route to send encrypted data to your cloud application.
1. Using your RSA private key to decrypt it upon receipt by your cloud application (e.g. using a Note.js or OpenSSL cloud function).

> **NOTE:** You can find a step-by-step implementation guide right here: [Encrypting Data with the Notecard](https://dev.blues.io/notecard/notecard-guides/encrypting-data-with-the-notecard/).

## Securing Data in Transit

With your data fully encrypted before it leaves the device, and properly decrypted at its final endpoint on your cloud, we should also take a look at how your data is also secured in transit.

**Spoiler alert!** This has been the case since the Notecard was first released, as it was built quite literally with security in mind.

IMAGE

On the hardware side, the Notecard includes a factory-installed ECC P-384 certificate provisioned at chip manufacture, an integrated STSAFE Secure Element with hardware crypto, and a true hardware random number generator.

On the communications side, transactional data is secured without any provisioning challenges, using encrypted "off the internet" communication.

When the host is set to the default of a.notefile.net, the Notecard selects an APN where the connection between at&t's network and the Notehub is made over a VPN. So the messages are not being passed "on the internet" - meaning not on the public network. We use internal DNS servers to resolve to the Notehub.
If they switch the host to a different string, say "some-other-notehub.com" - the Notecard selects another APN where there is no VPN tunnel for the connection - is on the public network.
And the encryption is that the connection is encrypted using TLS (edited) 

## Try it Yourself

1. Upgrade your Notecard firmware to 1.5.5 (or greater).
2. Read the step-by-step encryption guide.
3. Rest easy knowing your data is encrypted from your device to your cloud!

